<section class="magazine-section my-5">
  <div class="row">
    <div class="col-lg-2 col-md-12">
      <mat-accordion>
        <mat-expansion-panel [expanded]="true">
          <mat-expansion-panel-header>
            <mat-panel-title>
              내 프로필
            </mat-panel-title>
          </mat-expansion-panel-header>
          <p class="pointer" (click)="onSelectMyVideos()" [style.background-color]="myVideos ? '#94c3f4' : ''">
            My Videos
          </p>
          <p class="pointer" (click)="onSelectChangePassword()" [style.background-color]="changePassword ? '#94c3f4' : ''">
            비밀번호 변경
          </p>
        </mat-expansion-panel>
      </mat-accordion>
    </div>

    <div class="col-lg-10 col-md-12" *ngIf="isMyVideosLoaded">
      <div class="row">
        <div class="col-md-10 mx-auto">
          <div class="md-form">
            <input type="text" [(ngModel)]="searchText" class="form-control" id="search" mdbInputDirective>
            <label for="search">검색</label>
          </div>
        </div>
        <div class="col-md-3" *ngFor="let card of searchResult | searchFilter: {uploader: searchText, uploadedDate: searchText, countryKR: searchText, title: searchText} | paginate: { itemsPerPage: 8, currentPage: page }">
          <mat-card class="card card-body mb-3" (click)="onMatCardClick(card.videoPostId, card.youTubeVideoId, card.categoryId)"
            style="cursor:pointer;">
            <mat-card-header>
              <div mat-card-avatar class="example-header-image" [ngStyle]="{'background-image':'url(' + backgroundUrl + card.countryEN +'.png' + ')'}"></div>
              <mat-card-title>{{card.uploader}}</mat-card-title>
              <mat-card-subtitle>{{card.uploadedDate | date:'yyyy-MM-dd'}}</mat-card-subtitle>
            </mat-card-header>
            <img mat-card-image src="https://img.youtube.com/vi/{{card.youTubeVideoId}}/hqdefault.jpg">
            <mat-card-content>
              <h6><strong>{{card.countryKR}} {{card.title}}</strong></h6>
            </mat-card-content>
          </mat-card>
        </div>
      </div>
      <br />
      <div class="has-text-centered">
        <pagination-controls (pageChange)="page = $event"></pagination-controls>
      </div>
    </div>

    <div class="col-lg-4 col-md-12">
      <div class="row" *ngIf="isChangePasswordLoaded">
        <form (ngSubmit)="onSubmit()" [formGroup]="changePasswordForm">
          <h2>비밀번호 변경</h2>
          <br />
          <div *ngIf="error" style="color: red;">
            {{error}}
            <br /><br />
          </div>
          <mat-card-content>
            <mat-form-field appearance="outline" class="input-size">
              <mat-label>현재 비밀번호</mat-label>
              <input matInput type="password" placeholder="현재 비밀번호" formControlName="oldPassword" [formControl]="oldPasswordFormControl"
                [errorStateMatcher]="matcher" />
              <mat-error *ngIf="oldPasswordFormControl.hasError('pattern') && !oldPasswordFormControl.hasError('required')">
                최소 8글자에 숫자, 대소문자를 섞어주세요.
              </mat-error>
            </mat-form-field>
            <mat-form-field appearance="outline" class="input-size">
              <mat-label>새로운 비밀번호</mat-label>
              <input matInput type="password" placeholder="새로운 비밀번호" formControlName="newPassword" [formControl]="newPasswordFormControl"
                [errorStateMatcher]="matcher" />
              <mat-error *ngIf="newPasswordFormControl.hasError('pattern') && !newPasswordFormControl.hasError('required')">
                최소 8글자에 숫자, 대소문자를 섞어주세요.
              </mat-error>
            </mat-form-field>
            <mat-form-field appearance="outline" class="input-size">
              <mat-label>비밀번호 재확인</mat-label>
              <input matInput type="password" placeholder="비밀번호 재확인" formControlName="confirmPassword" [formControl]="confirmPasswordFormControl"
                [errorStateMatcher]="matcher" />
              <mat-error *ngIf="confirmPasswordFormControl.hasError('pattern') && !confirmPasswordFormControl.hasError('required')">
                최소 8글자에 숫자, 대소문자를 섞어주세요.
              </mat-error>
            </mat-form-field>
          </mat-card-content>
          <div>
            <button style="margin: auto;" mat-raised-button [disabled]="!(changePasswordForm.controls.oldPassword.valid && 
            changePasswordForm.controls.newPassword.valid && 
            changePasswordForm.controls.confirmPassword.valid)"
              color="accent">
              비밀번호 변경
            </button>
          </div>
        </form>
      </div>
    </div>
  </div>
</section>